ä½¿ç”¨nmapæ‰«ææœåŠ¡å’Œç‰ˆæœ¬ è¿›è¡Œå…¨ç«¯å£æ‰«æ
æ‰«æä¸€å…±65535ä¸ªç«¯å£æ¯”è¾ƒæ…¢ æŒ‰å›è½¦å¯ä»¥æŸ¥çœ‹è¿›åº¦
â”Œâ”€â”€(rootğŸ’€tyza66)-[~/aircrack_8812au]
â””â”€# msfdb run
[i] Database already started
Metasploit tip: Start commands with a space to avoid saving them to history
                                                  

                 _---------.
             .' #######   ;."
  .---,.    ;@             @@`;   .---,..
." @@@@@'.,'@@            @@@@@',.'@@@@ ".
'-.@@@@@@@@@@@@@          @@@@@@@@@@@@@ @;
   `.@@@@@@@@@@@@        @@@@@@@@@@@@@@ .'
     "--'.@@@  -.@        @ ,'-   .'--"
          ".@' ; @       @ `.  ;'
            |@@@@ @@@     @    .
             ' @@@ @@   @@    ,
              `.@@@@    @@   .
                ',@@     @   ;           _____________
                 (   3 C    )     /|___ / Metasploit! \
                 ;@'. __*__,."    \|--- \_____________/
                  '(.,...."/


       =[ metasploit v6.4.9-dev                           ]
+ -- --=[ 2420 exploits - 1248 auxiliary - 423 post       ]
+ -- --=[ 1468 payloads - 47 encoders - 11 nops           ]
+ -- --=[ 9 evasion                                       ]

Metasploit Documentation: https://docs.metasploit.com/

msf6 > db_nmap -p- -sV 192.168.101.180
[*] Nmap: Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-17 07:38 CST
[*] Nmap: Stats: 0:00:48 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
[*] Nmap: SYN Stealth Scan Timing: About 35.74% done; ETC: 07:41 (0:01:26 remaining)

åœ¨å±€åŸŸç½‘å†…å¯ä»¥ä¾é ARPåè®®æ¢æµ‹ç½‘æ®µå†…æœ‰å“ªäº›å­˜æ´»ä¸»æœº
SHOST å’Œ SMACæ˜¯å¯ä»¥ä¼ªè£…çš„

msf6 > use auxiliary/scanner/discovery/arp_sweep
msf6 auxiliary(scanner/discovery/arp_sweep) > show options

Module options (auxiliary/scanner/discovery/arp_sweep):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   INTERFACE                   no        The name of the interface
   RHOSTS                      yes       The target host(s), see https://docs.metasploit
                                         .com/docs/using-metasploit/basics/using-metaspl
                                         oit.html
   SHOST                       no        Source IP Address
   SMAC                        no        Source MAC Address
   THREADS    1                yes       The number of concurrent threads (max one per h
                                         ost)
   TIMEOUT    5                yes       The number of seconds to wait for new data


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/discovery/arp_sweep) > set RHOSTS 192.16.101.0/24
RHOSTS => 192.16.101.0/24
msf6 auxiliary(scanner/discovery/arp_sweep) > run

[+] 192.168.101.180 appears to be up (VMware, Inc.).
^C[*] Caught interrupt from the console...
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/discovery/arp_sweep) > set RHOSTS 192.168.101.0/24
RHOSTS => 192.168.101.0/24
msf6 auxiliary(scanner/discovery/arp_sweep) > run

[+] 192.168.101.1 appears to be up (UNKNOWN).
[+] 192.168.101.26 appears to be up (Intel Corporate).
[+] 192.168.101.180 appears to be up (VMware, Inc.).
[+] 192.168.101.86 appears to be up (UNKNOWN).
[+] 192.168.101.88 appears to be up (UNKNOWN).
[+] 192.168.101.93 appears to be up (UNKNOWN).
[+] 192.168.101.94 appears to be up (UNKNOWN).
[+] 192.168.101.95 appears to be up (UNKNOWN).
[+] 192.168.101.96 appears to be up (UNKNOWN).
[+] 192.168.101.99 appears to be up (VMware, Inc.).
[+] 192.168.101.180 appears to be up (VMware, Inc.).
[+] 192.168.101.180 appears to be up (VMware, Inc.).
^C[*] Caught interrupt from the console...
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/discovery/arp_sweep) > 

é™¤äº†ç”¨arpæ‰«æè¿˜å¯ä»¥ç”¨åŠè¿æ¥çš„æ–¹å¼è¿›è¡Œæ‰«æ
msf6 auxiliary(scanner/discovery/arp_sweep) > search portscan

Matching Modules
================

   #  Name                                              Disclosure Date  Rank    Check  Description
   -  ----                                              ---------------  ----    -----  -----------
   0  auxiliary/scanner/portscan/ftpbounce              .                normal  No     FTP Bounce Port Scanner
   1  auxiliary/scanner/natpmp/natpmp_portscan          .                normal  No     NAT-PMP External Port Scanner
   2  auxiliary/scanner/sap/sap_router_portscanner      .                normal  No     SAPRouter Port Scanner
   3  auxiliary/scanner/portscan/xmas                   .                normal  No     TCP "XMas" Port Scanner
   4  auxiliary/scanner/portscan/ack                    .                normal  No     TCP ACK Firewall Scanner
   5  auxiliary/scanner/portscan/tcp                    .                normal  No     TCP Port Scanner
   6  auxiliary/scanner/portscan/syn                    .                normal  No     TCP SYN Port Scanner
   7  auxiliary/scanner/http/wordpress_pingback_access  .                normal  No     Wordpress Pingback Locator


Interact with a module by name or index. For example info 7, use 7 or use auxiliary/scannr/http/wordpress_pingback_access                                                         

msf6 auxiliary(scanner/discovery/arp_sweep) > back
msf6 > use auxiliary/scanner/portscan/syn 
msf6 auxiliary(scanner/portscan/syn) > set RHOSTS 192.168.101.180
RHOSTS => 192.168.101.180
msf6 auxiliary(scanner/portscan/syn) > set PORTS 80
PORTS => 80
msf6 auxiliary(scanner/portscan/syn) > run

[+]  TCP OPEN 192.168.101.180:80
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/portscan/syn) > Interrupt: use the 'exit' command to quit
msf6 auxiliary(scanner/portscan/syn) > set PORTS 21-100
PORTS => 21-100
msf6 auxiliary(scanner/portscan/syn) > run

[+]  TCP OPEN 192.168.101.180:21
[+]  TCP OPEN 192.168.101.180:80
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed


æ‰«æåˆ°ç»“æœä¹‹å å¯ä»¥è¿›è¡Œæ•æ„Ÿä¿¡æ¯æ”¶é›†
ä½¿ç”¨psnuffleè¿›è¡Œå—…æ¢
å¯ä»¥åœ¨çº¿å—…æ¢ ä¹Ÿå¯ä»¥ç¦»çº¿å—…æ¢å·²ç»æŠ“åˆ°çš„æ•°æ®åŒ…
æˆ‘ä»¬å…ˆä¸ç”¨è®¾ç½®ç›´æ¥run
æŒ‰ä¸‹å›è½¦ä¹‹åå°±å¯ä»¥åœ¨åå°ç›‘å¬


msf6 > search psnuffle

Matching Modules
================

   #  Name                        Disclosure Date  Rank    Check  Description
   -  ----                        ---------------  ----    -----  -----------
   0  auxiliary/sniffer/psnuffle  .                normal  No     pSnuffle Packet Sniffer
   1    \_ action: List           .                .       .      List protocols
   2    \_ action: Sniffer        .                .       .      Run sniffer


Interact with a module by name or index. For example info 2, use 2 or use auxiliary/sniffer/psnuffle                                                                              
After interacting with a module you can manually set a ACTION with set ACTION 'Sniffer'

msf6 > use 0
msf6 auxiliary(sniffer/psnuffle) > options

Module options (auxiliary/sniffer/psnuffle):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   FILTER                      no        The filter string for capturing traffic
   INTERFACE                   no        The name of the interface
   PCAPFILE                    no        The name of the PCAP capture file to process
   PROTOCOLS  all              yes       A comma-delimited list of protocols to sniff o
                                         r "all".
   SNAPLEN    65535            yes       The number of bytes to capture
   TIMEOUT    500              yes       The number of seconds to wait for new data


Auxiliary action:

   Name     Description
   ----     -----------
   Sniffer  Run sniffer



View the full module info with the info, or info -d command.

msf6 auxiliary(sniffer/psnuffle) > run
[*] Auxiliary module running as background job 0.
msf6 auxiliary(sniffer/psnuffle) > 
[*] Loaded protocol FTP from /usr/share/metasploit-framework/data/exploits/psnuffle/ftp.rb...
[*] Loaded protocol IMAP from /usr/share/metasploit-framework/data/exploits/psnuffle/imap.rb...
[*] Loaded protocol POP3 from /usr/share/metasploit-framework/data/exploits/psnuffle/pop3.rb...
[*] Loaded protocol SMB from /usr/share/metasploit-framework/data/exploits/psnuffle/smb.rb...
[*] Loaded protocol URL from /usr/share/metasploit-framework/data/exploits/psnuffle/url.rb...
[*] Sniffing traffic.....

msf6 auxiliary(sniffer/psnuffle) > hobs
[-] Unknown command: hobs. Run the help command for more details.
msf6 auxiliary(sniffer/psnuffle) > jobs

Jobs
====

  Id  Name                         Payload  Payload opts
  --  ----                         -------  ------------
  0   Auxiliary: sniffer/psnuffle

msf6 auxiliary(sniffer/psnuffle) 

é»˜è®¤å›å—…æ¢æ•´ä¸ªç½‘æ®µå†…çš„æ•æ„Ÿä¿¡æ¯

æˆ‘ä»¬å¦å¼€ä¸€ä¸ªç»ˆç«¯ å°è¯•è¿æ¥ftp å®éªŒè´¦å·å’Œå¯†ç è¢«æ•è·
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# apt update         
å‘½ä¸­:1 https://mirrors.ustc.edu.cn/kali kali-last-snapshot InRelease
æœ‰ 1906 ä¸ªè½¯ä»¶åŒ…å¯ä»¥å‡çº§ã€‚è¯·æ‰§è¡Œ â€˜apt list --upgradableâ€™ æ¥æŸ¥çœ‹å®ƒä»¬ã€‚
                                                                             
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# apt install lftp   
ä¸‹åˆ—è½¯ä»¶åŒ…æ˜¯è‡ªåŠ¨å®‰è£…çš„å¹¶ä¸”ç°åœ¨ä¸éœ€è¦äº†ï¼š       
  cpp-13                   libgfrpc0         librdmacm1t64
  ibverbs-providers        libgfxdr0         python3-lib2to3
  libboost-iostreams1.83.0 libglusterfs0     python3.11
  libboost-thread1.83.0    libibverbs1       python3.11-dev
  libcephfs2               libpython3.11-dev python3.11-minimal
  libgfapi0                librados2         samba-vfs-modules
ä½¿ç”¨'apt autoremove'æ¥å¸è½½å®ƒ(å®ƒä»¬)ã€‚

å°†è¦å®‰è£…ï¼š
  lftp

æ‘˜è¦ï¼š
  å‡çº§ï¼š0ï¼Œå®‰è£…ï¼š1ï¼Œå¸è½½ï¼š0ï¼Œä¸å‡çº§ï¼š1906
  ä¸‹è½½å¤§å°ï¼š768 kB
  æ‰€éœ€çš„ç©ºé—´ï¼š2,434 kB / 83.5 GB å¯ç”¨

è·å–:1 https://mirrors.ustc.edu.cn/kali kali-last-snapshot/main amd64 lftp amd64 4.9.2-3+b1 [768 kB]
å·²ä¸‹è½½ 768 kBï¼Œè€—æ—¶ 0ç§’ (1,581 kB/s)
æ­£åœ¨é€‰ä¸­æœªé€‰æ‹©çš„è½¯ä»¶åŒ… lftpã€‚
(æ­£åœ¨è¯»å–æ•°æ®åº“ ... ç³»ç»Ÿå½“å‰å…±å®‰è£…æœ‰ 417416 ä¸ªæ–‡ä»¶å’Œç›®å½•ã€‚)
å‡†å¤‡è§£å‹ .../lftp_4.9.2-3+b1_amd64.deb  ...
æ­£åœ¨è§£å‹ lftp (4.9.2-3+b1) ...
æ­£åœ¨è®¾ç½® lftp (4.9.2-3+b1) ...
æ­£åœ¨å¤„ç†ç”¨äº kali-menu (2023.4.7) çš„è§¦å‘å™¨ ...
æ­£åœ¨å¤„ç†ç”¨äº desktop-file-utils (0.27-2) çš„è§¦å‘å™¨ ...
æ­£åœ¨å¤„ç†ç”¨äº hicolor-icon-theme (0.17-2) çš„è§¦å‘å™¨ ...
æ­£åœ¨å¤„ç†ç”¨äº man-db (2.12.1-1) çš„è§¦å‘å™¨ ...
                                                                             
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# lftp 192.168.101.180 -u msfadmin
å¯†ç : 
lftp msfadmin@192.168.101.180:~> ls                   
`ls' åœ¨ 0 [æ­£åœ¨å»ºç«‹æ•°æ®è¿æ¥...]

ä¹‹åæˆ‘ä»¬å»ç›‘å¬é‚£è¾¹å°±å¯ä»¥çœ‹åˆ°
sf6 auxiliary(sniffer/psnuffle) > jobs -i 0

Name: pSnuffle Packet Sniffer, started at 2025-02-17 07:54:53 +0800

Module options (auxiliary/sniffer/psnuffle):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   FILTER                      no        The filter string for capturing traffic
   INTERFACE                   no        The name of the interface
   PCAPFILE                    no        The name of the PCAP capture file to process
   PROTOCOLS  all              yes       A comma-delimited list of protocols to sniff o
                                         r "all".
   SNAPLEN    65535            yes       The number of bytes to capture
   TIMEOUT    500              yes       The number of seconds to wait for new data


Auxiliary action:

   Name     Description
   ----     -----------
   Sniffer  Run sniffer



View the full module info with the info, or info -d command.

msf6 auxiliary(sniffer/psnuffle) > 
[*] Successful FTP Login: 192.168.101.53:56034-192.168.101.180:21 >> msfadmin / msfadmin

msf6 auxiliary(sniffer/psnuffle) > 
[*] Successful FTP Login: 192.168.101.53:60290-192.168.101.180:21 >> msfadmin / msfadmin

åŒæ—¶å±€åŸŸç½‘è¿æ¥å¤–ç½‘çš„æ—¶å€™ä¹Ÿå¯ä»¥è¢«ç›‘å¬åˆ°

ftpè¿æ¥ä¸Šä¹‹åä¸€ç›´æ²¡æœ‰ååº”
å› ä¸ºlftpé»˜è®¤ä½¿ç”¨è¢«åŠ¨æ–¹å¼è¿›è¡Œè¿æ¥æœåŠ¡ å½“å‰ä¸æ”¯æŒ
æ‰“å¼€é‚£ä¸ªæ³¨é‡Šå°±æ˜¯ä¸»åŠ¨æ¨¡å¼äº†
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# lftp 192.168.101.180 -u msfadmin
å¯†ç : 
lftp msfadmin@192.168.101.180:~> ls                   
`ls' åœ¨ 0 [æ­£åœ¨å»ºç«‹æ•°æ®è¿æ¥...]

ä¸­æ–­                                        
lftp msfadmin@192.168.101.180:/> 
lftp msfadmin@192.168.101.180:/> exit
                                                                             
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# vim /etc/lftp.cong      
                                                                             
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# vim /etc/lftp.conf
                                                                             
â”Œâ”€â”€(rootğŸ’€tyza66)-[~]
â””â”€# lftp 192.168.101.180 -u msfadmin
å¯†ç : 
lftp msfadmin@192.168.101.180:~> ls                   
-rw-r--r--   1 33       33          58875 Jul 27  2011 CHANGELOG.txt
-rw-r--r--   1 33       33            996 Jul 27  2011 COPYRIGHT.txt
-rw-r--r--   1 33       33           1447 Jul 27  2011 INSTALL.mysql.txt
-rw-r--r--   1 33       33           1874 Jul 27  2011 INSTALL.pgsql.txt
-rw-r--r--   1 33       33           1298 Jul 27  2011 INSTALL.sqlite.txt
-rw-r--r--   1 33       33          17856 Jul 27  2011 INSTALL.txt
-rw-r--r--   1 33       33          14940 Feb 24  2011 LICENSE.txt
-rw-r--r--   1 33       33           7356 Jul 27  2011 MAINTAINERS.txt
-rw-r--r--   1 33       33           3494 Jul 27  2011 README.txt
-rw-r--r--   1 33       33           8811 Jul 27  2011 UPGRADE.txt
-rw-r--r--   1 33       33           6605 Jul 27  2011 authorize.php
-rw-r--r--   1 33       33            720 Jul 27  2011 cron.php
drwxr-xr-x   4 33       33           4096 Jul 27  2011 includes
-rw-r--r--   1 33       33            529 Jul 27  2011 index.php
-rw-r--r--   1 33       33            688 Jul 27  2011 install.php
drwxr-xr-x   4 33       33           4096 Jul 27  2011 misc
drwxr-xr-x  42 33       33           4096 Jul 27  2011 modules
drwxr-xr-x   5 33       33           4096 Jul 27  2011 profiles
-rw-r--r--   1 33       33           1531 Jul 27  2011 robots.txt
drwxr-xr-x   2 33       33           4096 Jul 27  2011 scripts
drwxr-xr-x   4 33       33           4096 Jul 27  2011 sites
drwxr-xr-x   8 33       33           4096 Jul 27  2011 themes
-rw-r--r--   1 33       33          18039 Jul 27  2011 update.php
-rw-r--r--   1 33       33           2051 Jul 27  2011 web.config
-rw-r--r--   1 33       33            417 Jul 27  2011 xmlrpc.php
lftp msfadmin@192.168.101.180:/> 

æ¥ä¸‹æ¥æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•å°†æå–åˆ°çš„æ•°æ®åŒ…ä¸­æ”¯æŒçš„æ•°æ®æå–å‡ºæ¥
æ¯”å¦‚æˆ‘ä»¬ç”¨ä¸€ä¸ªwiresharkæŠ“åˆ°çš„ä¸€ä¸ªåŒ…
msf6 auxiliary(sniffer/psnuffle) > set PCAPFILE /home/dvwa.pcap
PCAPFILE => /home/dvwa.pcap
msf6 auxiliary(sniffer/psnuffle) > show options

Module options (auxiliary/sniffer/psnuffle):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   FILTER                      no        The filter string for capturing traffic
   INTERFACE                   no        The name of the interface
   PCAPFILE   /home/dvwa.pcap  no        The name of the PCAP capture file to process
   PROTOCOLS  all              yes       A comma-delimited list of protocols to sniff o
                                         r "all".
   SNAPLEN    65535            yes       The number of bytes to capture
   TIMEOUT    500              yes       The number of seconds to wait for new data


Auxiliary action:

   Name     Description
   ----     -----------
   Sniffer  Run sniffer



View the full module info with the info, or info -d command.

msf6 auxiliary(sniffer/psnuffle) > run
å³å¯
